<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="fu1252"><link rel="alternative" href="/atom.xml" title="MyBlog" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>React - MyBlog</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">MyBlog</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">目录</a></li><li class="head-nav__item"><a class="head-nav__link" href="https://github.com/fu1252">GitHub</a></li><li class="head-nav__item"><a class="head-nav__link" href="https://www.douban.com/people/fu1252/">豆瓣</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2018-10-10T12:42:54.000Z">October 10, 2018</time><h1 class="post__title"><a href="/2018/10/10/React/">React</a></h1><div class="post__main echo"><h3 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h3><p><a href="https://react.docschina.org/docs/introducing-jsx.html" target="_blank" rel="noopener">文档</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-react-app</span><br><span class="line">create-react-app my-app</span><br><span class="line">cd my-app/</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure>
<h4 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a>index.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import &apos;./index.css&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, document.getElementById(&apos;root&apos;));</span><br></pre></td></tr></table></figure>
<h4 id="App-js"><a href="#App-js" class="headerlink" title="App.js"></a>App.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line">import logo from &apos;./logo.svg&apos;;</span><br><span class="line">import &apos;./App.css&apos;;</span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        </span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<h3 id="jsx语法"><a href="#jsx语法" class="headerlink" title="jsx语法"></a>jsx语法</h3><p>在 JSX 当中的表达式要包含在大括号里  <strong>(vue是双引号)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const element = &lt;img src=&#123;user.avatarUrl&#125;&gt;&lt;/img&gt;;</span><br></pre></td></tr></table></figure></p>
<p>条件渲染<br>根据条件返回jsx html 或者组件，  <strong>(vue用i-if直接写在html属性里)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function getGreeting(user) &#123;</span><br><span class="line">  if (user) &#123;</span><br><span class="line">    return &lt;h1&gt;Hello, &#123;formatName(user)&#125;!&lt;/h1&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">  return &lt;h1&gt;Hello, Stranger.&lt;/h1&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>组件可由占位符代理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    const isLoggedIn = this.state.isLoggedIn;</span><br><span class="line">    let button = null;</span><br><span class="line">if (isLoggedIn) &#123;</span><br><span class="line">      button = &lt;LogoutButton onClick=&#123;this.handleLogoutClick&#125; /&gt;;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      button = &lt;LoginButton onClick=&#123;this.handleLoginClick&#125; /&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Greeting isLoggedIn=&#123;isLoggedIn&#125; /&gt;</span><br><span class="line">        &#123;button&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br></pre></td></tr></table></figure></p>
<p>简化方式：前面为真渲染后面html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;unreadMessages.length &gt; 0 &amp;&amp;</span><br><span class="line">   &lt;h2&gt;</span><br><span class="line">     You have &#123;unreadMessages.length&#125; unread messages.</span><br><span class="line">   &lt;/h2&gt;</span><br></pre></td></tr></table></figure></p>
<p>隐藏组件：<br>返回null<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function WarningBanner(props) &#123;</span><br><span class="line">     if (!props.warn) &#123;</span><br><span class="line">     return null;</span><br></pre></td></tr></table></figure></p>
<h4 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const numbers = [1, 2, 3, 4, 5];</span><br><span class="line">const listItems = numbers.map((number) =&gt;</span><br><span class="line">  &lt;li key=&#123;number.toString()&#125;&gt;</span><br><span class="line">    &#123;number&#125;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">);</span><br><span class="line">return(</span><br><span class="line">&lt;ul&gt; &#123;listitems&#125; &lt;/ul&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><ul>
<li>组件名称必须以大写字母开头</li>
<li>constructor()<ul>
<li>state</li>
<li>bind(this) </li>
</ul>
</li>
<li>render()<ul>
<li>let ,var,console.log</li>
<li>return():jsx</li>
</ul>
</li>
<li>生命周期<ul>
<li>UNSAFE_componentWillMount() </li>
<li>componentDidMount()</li>
<li>shouldComponentUpdate()</li>
<li>componentDidUpdate()</li>
<li>componentWillUnmount()</li>
<li>componentDidCatch()</li>
</ul>
</li>
<li>defaultProps </li>
<li>propTypes<h4 id="proptypes"><a href="#proptypes" class="headerlink" title="proptypes"></a>proptypes</h4><a href="https://react.docschina.org/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">类型</a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import PropTypes from &apos;prop-types&apos;;</span><br><span class="line">Greeting.propTypes = &#123;</span><br><span class="line">  name: PropTypes.string</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="dedaultProps"><a href="#dedaultProps" class="headerlink" title="dedaultProps"></a>dedaultProps</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CustomButton.defaultProps = &#123;</span><br><span class="line">  color: &apos;blue&apos;</span><br><span class="line">&#125;; </span><br><span class="line">return &lt;CustomButton /&gt; ; // props.color will be set to blue</span><br></pre></td></tr></table></figure>
<h4 id="组件状态"><a href="#组件状态" class="headerlink" title="组件状态"></a>组件状态</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">constructor(props) &#123;</span><br><span class="line">   super(props);</span><br><span class="line">   this.state = &#123;comment:&apos;nihao&apos;&#125;;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="更改状态"><a href="#更改状态" class="headerlink" title="更改状态"></a>更改状态</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.setState(&#123;comment: &apos;Hello&apos;&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h4><p> 阻止默认行为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function handleClick(e) &#123;</span><br><span class="line">   e.preventDefault();</span><br><span class="line">   console.log(&apos;The link was clicked.&apos;);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>class组件里使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;this.handleClick&#125;&gt;</span><br></pre></td></tr></table></figure>
<p>class组件事件绑定this</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1： this.handleClick = this.handleClick.bind(this);</span><br><span class="line">2： handleClick = () =&gt; &#123;console.log(&apos;this is:&apos;, this);&#125;</span><br><span class="line">3：&lt;button onClick=&#123;(e) =&gt; this.handleClick(param,e)&#125;/&gt;或者this.handleClick.bind(this,param)</span><br></pre></td></tr></table></figure>
<h4 id="父组件中dom由子组件渲染-vue中slot"><a href="#父组件中dom由子组件渲染-vue中slot" class="headerlink" title="父组件中dom由子组件渲染 (vue中slot)"></a>父组件中dom由子组件渲染 <strong>(vue中slot)</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;Detail&gt;这里就是children的内容&lt;/Detail&gt;</span><br><span class="line">Detail:  return (</span><br><span class="line">      &lt;div className=&quot;container&quot;&gt;</span><br><span class="line">        &lt;h1&gt;first title &lt;/h1&gt;</span><br><span class="line">        &#123;this.props.children&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"> 插入其他节点：</span><br><span class="line">  return ReactDOM.createPortal(</span><br><span class="line">    this.props.children,</span><br><span class="line">    domNode,</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>
<h4 id="父组件向子组件传值"><a href="#父组件向子组件传值" class="headerlink" title="父组件向子组件传值"></a>父组件向子组件传值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;Welcome name=&quot;Sara&quot; /&gt;;</span><br><span class="line">function Welcome(props) &#123;</span><br><span class="line">  return &lt;h1&gt;Hello, &#123;props.name&#125;&lt;/h1&gt;;</span><br><span class="line">&#125;</span><br><span class="line">或者</span><br><span class="line">class Welcome extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;h1&gt;Hello, &#123;this.props.name&#125;&lt;/h1&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h3><p>输入数据的值为event.target.value<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">handleChange(event) &#123;</span><br><span class="line">    this.setState(&#123;value: event.target.value&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;form onSubmit=&#123;this.handleSubmit&#125;&gt;</span><br><span class="line">        &lt;label&gt;</span><br><span class="line">          Name:</span><br><span class="line">          &lt;input type=&quot;text&quot; value=&#123;this.state.value&#125; onChange=&#123;this.handleChange&#125; /&gt;</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;</span><br><span class="line">      &lt;/form&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="访问DOM元素-ref"><a href="#访问DOM元素-ref" class="headerlink" title="访问DOM元素 ref"></a>访问DOM元素 ref</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">定义： &lt;input type=&quot;text&quot;ref=&#123;this.textInput&#125; /&gt;</span><br><span class="line">创造：super(props);</span><br><span class="line">this.textInput=React.createRef();</span><br><span class="line">使用：focusTextInput() &#123;</span><br><span class="line">      this.textInput.current.focus();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>回调ref</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">this.textInput = null;</span><br><span class="line">    this.setTextInputRef = element =&gt; &#123;</span><br><span class="line">      this.textInput = element;</span><br><span class="line">    &#125;;</span><br><span class="line">    this.focusTextInput = () =&gt; &#123;</span><br><span class="line">      if (this.textInput) this.textInput.focus();</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>
<h3 id="Throttle节流函数"><a href="#Throttle节流函数" class="headerlink" title="Throttle节流函数"></a>Throttle节流函数</h3><p>避免onclick或onscroll触发太快太多  <strong>(可用lodash相关函数)</strong><br>节流是阻止函数在给定时间内被多次调用，下面例子阻止“click”事件每秒钟的多次调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">constructor(props) &#123;</span><br><span class="line">    this.handleClickThrottled = throttle(this.handleClick, 1000);</span><br><span class="line">  &#125;</span><br><span class="line">   componentWillUnmount() &#123;</span><br><span class="line">    this.handleClickThrottled.cancel();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Debounce防抖函数"><a href="#Debounce防抖函数" class="headerlink" title="Debounce防抖函数"></a>Debounce防抖函数</h3><p>防抖确保函数上次执行后的一段时间内，不会再次执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">this.emitChangeDebounced = debounce(this.emitChange, 250);</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    this.emitChangeDebounced.cancel();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="fragments"><a href="#fragments" class="headerlink" title="fragments"></a>fragments</h3><p>组件中多个元素的根元素替代元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;ChildA /&gt;</span><br><span class="line">      &lt;ChildB /&gt;</span><br><span class="line">      &lt;ChildC /&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  );</span><br><span class="line">  或者 </span><br><span class="line">  &lt;React.Fragment&gt;</span><br><span class="line">        &lt;td&gt;Hello&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;World&lt;/td&gt;</span><br><span class="line">  &lt;/React.Fragment&gt;</span><br></pre></td></tr></table></figure>
</div></header></article></main><footer class="foot"><div class="foot-copy">&copy; 2017-2018 fu1252</div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>